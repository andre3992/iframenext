{"ast":null,"code":"import _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nvar _jsxFileName = \"C:\\\\Users\\\\BO0004\\\\Desktop\\\\repositorios\\\\iframe-endesapt\\\\utils\\\\MessengerChat.js\";\nvar __jsx = React.createElement;\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\n/**\r\n * Utils\r\n */\n\nvar removeElementByIds = function removeElementByIds(ids) {\n  ids.forEach(function (id) {\n    var element = document.getElementById(id);\n\n    if (element && element.parentNode) {\n      element.parentNode.removeChild(element);\n    }\n  });\n};\n/**\r\n * Messenger Chat Plugin\r\n */\n\n\nvar MessengerChat = /*#__PURE__*/function (_Component) {\n  _inherits(MessengerChat, _Component);\n\n  var _super = _createSuper(MessengerChat);\n\n  function MessengerChat(props) {\n    var _this;\n\n    _classCallCheck(this, MessengerChat);\n\n    _this = _super.call(this, props);\n    _this.setFbAsyncInit = _this.setFbAsyncInit.bind(_assertThisInitialized(_this));\n    _this.reloadSDKAsynchronously = _this.reloadSDKAsynchronously.bind(_assertThisInitialized(_this));\n    _this.loadSDKAsynchronously = _this.loadSDKAsynchronously.bind(_assertThisInitialized(_this));\n    _this.createMarkup = _this.createMarkup.bind(_assertThisInitialized(_this));\n    _this.controlPlugin = _this.controlPlugin.bind(_assertThisInitialized(_this));\n    _this.subscribeEvents = _this.subscribeEvents.bind(_assertThisInitialized(_this));\n    _this.removeFacebookSDK = _this.removeFacebookSDK.bind(_assertThisInitialized(_this));\n    _this.state = {\n      fbLoaded: false,\n      shouldShowDialog: undefined\n    };\n    return _this;\n  }\n\n  _createClass(MessengerChat, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.setFbAsyncInit();\n      this.reloadSDKAsynchronously();\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps) {\n      if (prevProps.pageId !== this.props.pageId || // prevProps.appId !== this.props.appId ||\n      prevProps.shouldShowDialog !== this.props.shouldShowDialog || prevProps.htmlRef !== this.props.htmlRef || prevProps.minimized !== this.props.minimized || prevProps.themeColor !== this.props.themeColor || prevProps.loggedInGreeting !== this.props.loggedInGreeting || prevProps.loggedOutGreeting !== this.props.loggedOutGreeting || prevProps.greetingDialogDisplay !== this.props.greetingDialogDisplay || prevProps.greetingDialogDelay !== this.props.greetingDialogDelay || prevProps.autoLogAppEvents !== this.props.autoLogAppEvents || prevProps.xfbml !== this.props.xfbml || prevProps.version !== this.props.version || prevProps.language !== this.props.language) {\n        this.setFbAsyncInit();\n        this.reloadSDKAsynchronously();\n      }\n    }\n  }, {\n    key: \"setFbAsyncInit\",\n    value: function setFbAsyncInit() {\n      var _this2 = this;\n\n      var _this$props = this.props,\n          autoLogAppEvents = _this$props.autoLogAppEvents,\n          xfbml = _this$props.xfbml,\n          version = _this$props.version;\n\n      window.fbAsyncInit = function () {\n        window.FB.init({\n          // appId,\n          autoLogAppEvents: autoLogAppEvents,\n          xfbml: xfbml,\n          version: \"v\".concat(version)\n        });\n\n        _this2.setState({\n          fbLoaded: true\n        });\n      };\n    }\n  }, {\n    key: \"loadSDKAsynchronously\",\n    value: function loadSDKAsynchronously() {\n      // const { language } = this.props\n\n      /* eslint-disable */\n      (function (d, s, id) {\n        var js,\n            fjs = d.getElementsByTagName(s)[0];\n\n        if (d.getElementById(id)) {\n          return;\n        }\n\n        js = d.createElement(s);\n        js.id = id;\n        js.src = \"https://connect.facebook.net/en_GB/sdk/xfbml.customerchat.js\";\n        fjs.parentNode.insertBefore(js, fjs);\n      })(document, \"script\", \"facebook-jssdk\");\n      /* eslint-enable */\n\n    }\n  }, {\n    key: \"removeFacebookSDK\",\n    value: function removeFacebookSDK() {\n      removeElementByIds([\"facebook-jssdk\", \"fb-root\"]);\n      delete window.FB;\n    }\n  }, {\n    key: \"reloadSDKAsynchronously\",\n    value: function reloadSDKAsynchronously() {\n      this.removeFacebookSDK();\n      this.loadSDKAsynchronously();\n    }\n  }, {\n    key: \"controlPlugin\",\n    value: function controlPlugin() {\n      var shouldShowDialog = this.props.shouldShowDialog;\n\n      if (shouldShowDialog) {\n        window.FB.CustomerChat.showDialog();\n      } else {\n        window.FB.CustomerChat.hideDialog();\n      }\n    }\n  }, {\n    key: \"subscribeEvents\",\n    value: function subscribeEvents() {\n      var _this$props2 = this.props,\n          onCustomerChatDialogShow = _this$props2.onCustomerChatDialogShow,\n          onCustomerChatDialogHide = _this$props2.onCustomerChatDialogHide;\n\n      if (onCustomerChatDialogShow) {\n        window.FB.Event.subscribe(\"customerchat.dialogShow\", onCustomerChatDialogShow);\n      }\n\n      if (onCustomerChatDialogHide) {\n        window.FB.Event.subscribe(\"customerchat.dialogHide\", onCustomerChatDialogHide);\n      }\n    }\n  }, {\n    key: \"createMarkup\",\n    value: function createMarkup() {\n      var _this$props3 = this.props,\n          pageId = _this$props3.pageId,\n          htmlRef = _this$props3.htmlRef,\n          minimized = _this$props3.minimized,\n          themeColor = _this$props3.themeColor,\n          loggedInGreeting = _this$props3.loggedInGreeting,\n          loggedOutGreeting = _this$props3.loggedOutGreeting,\n          greetingDialogDisplay = _this$props3.greetingDialogDisplay,\n          greetingDialogDelay = _this$props3.greetingDialogDelay;\n      var refAttribute = htmlRef !== undefined ? \"ref=\\\"\".concat(htmlRef, \"\\\"\") : \"\";\n      var minimizedAttribute = minimized !== undefined ? \"minimized=\\\"\".concat(minimized, \"\\\"\") : \"\";\n      var themeColorAttribute = themeColor !== undefined ? \"theme_color=\\\"\".concat(themeColor, \"\\\"\") : \"\";\n      var loggedInGreetingAttribute = loggedInGreeting !== undefined ? \"logged_in_greeting=\\\"\".concat(loggedInGreeting, \"\\\"\") : \"\";\n      var loggedOutGreetingAttribute = loggedOutGreeting !== undefined ? \"logged_out_greeting=\\\"\".concat(loggedOutGreeting, \"\\\"\") : \"\";\n      var greetingDialogDisplayAttribute = greetingDialogDisplay !== undefined ? \"greeting_dialog_display=\\\"\".concat(greetingDialogDisplay, \"\\\"\") : \"\";\n      var greetingDialogDelayAttribute = greetingDialogDelay !== undefined ? \"greeting_dialog_delay=\\\"\".concat(greetingDialogDelay, \"\\\"\") : \"\";\n      return {\n        __html: \"<div\\n             className=\\\"fb-customerchat\\\"\\n             page_id=\\\"\".concat(pageId, \"\\\"\\n             \").concat(refAttribute, \"\\n             \").concat(minimizedAttribute, \"\\n             \").concat(themeColorAttribute, \"\\n             \").concat(loggedInGreetingAttribute, \"\\n             \").concat(loggedOutGreetingAttribute, \"\\n             \").concat(greetingDialogDisplayAttribute, \"\\n             \").concat(greetingDialogDelayAttribute, \"\\n           ></div>\")\n      };\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      var _this$state = this.state,\n          fbLoaded = _this$state.fbLoaded,\n          shouldShowDialog = _this$state.shouldShowDialog;\n\n      if (fbLoaded && shouldShowDialog !== this.props.shouldShowDialog) {\n        document.addEventListener(\"DOMNodeInserted\", function (event) {\n          var element = event.target;\n\n          if (element.className && typeof element.className === \"string\" && element.className.includes(\"fb_dialog\")) {\n            _this3.controlPlugin();\n          }\n        }, false);\n        this.subscribeEvents();\n      } // Add a random key to rerender. Reference:\n      // https://stackoverflow.com/questions/30242530/dangerouslysetinnerhtml-doesnt-update-during-render\n\n\n      return __jsx(\"div\", {\n        key: Date(),\n        dangerouslySetInnerHTML: this.createMarkup(),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 246,\n          columnNumber: 12\n        }\n      });\n    }\n  }]);\n\n  return MessengerChat;\n}(Component);\n\n_defineProperty(MessengerChat, \"propTypes\", {\n  pageId: PropTypes.string.isRequired,\n  // appId:                    PropTypes.string.isRequired,\n  shouldShowDialog: PropTypes.bool,\n  htmlRef: PropTypes.string,\n  minimized: PropTypes.bool,\n  themeColor: PropTypes.string,\n  loggedInGreeting: PropTypes.string,\n  loggedOutGreeting: PropTypes.string,\n  greetingDialogDisplay: PropTypes.oneOf([\"show\", \"hide\", \"fade\"]),\n  greetingDialogDelay: PropTypes.number,\n  autoLogAppEvents: PropTypes.bool,\n  xfbml: PropTypes.bool,\n  version: PropTypes.string,\n  // language:                 PropTypes.string,\n  onCustomerChatDialogShow: PropTypes.func,\n  onCustomerChatDialogHide: PropTypes.func\n});\n\n_defineProperty(MessengerChat, \"defaultProps\", {\n  shouldShowDialog: false,\n  htmlRef: undefined,\n  minimized: undefined,\n  themeColor: undefined,\n  loggedInGreeting: undefined,\n  loggedOutGreeting: undefined,\n  greetingDialogDisplay: undefined,\n  greetingDialogDelay: undefined,\n  autoLogAppEvents: true,\n  xfbml: true,\n  version: \"4.0\",\n  onCustomerChatDialogShow: undefined,\n  onCustomerChatDialogHide: undefined\n});\n\nexport default MessengerChat;","map":{"version":3,"sources":["C:/Users/BO0004/Desktop/repositorios/iframe-endesapt/utils/MessengerChat.js"],"names":["React","Component","PropTypes","removeElementByIds","ids","forEach","id","element","document","getElementById","parentNode","removeChild","MessengerChat","props","setFbAsyncInit","bind","reloadSDKAsynchronously","loadSDKAsynchronously","createMarkup","controlPlugin","subscribeEvents","removeFacebookSDK","state","fbLoaded","shouldShowDialog","undefined","prevProps","pageId","htmlRef","minimized","themeColor","loggedInGreeting","loggedOutGreeting","greetingDialogDisplay","greetingDialogDelay","autoLogAppEvents","xfbml","version","language","window","fbAsyncInit","FB","init","setState","d","s","js","fjs","getElementsByTagName","createElement","src","insertBefore","CustomerChat","showDialog","hideDialog","onCustomerChatDialogShow","onCustomerChatDialogHide","Event","subscribe","refAttribute","minimizedAttribute","themeColorAttribute","loggedInGreetingAttribute","loggedOutGreetingAttribute","greetingDialogDisplayAttribute","greetingDialogDelayAttribute","__html","addEventListener","event","target","className","includes","Date","string","isRequired","bool","oneOf","number","func"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\n\r\n/**\r\n * Utils\r\n */\r\nconst removeElementByIds = (ids) => {\r\n  ids.forEach((id) => {\r\n    const element = document.getElementById(id);\r\n    if (element && element.parentNode) {\r\n      element.parentNode.removeChild(element);\r\n    }\r\n  });\r\n};\r\n\r\n/**\r\n * Messenger Chat Plugin\r\n */\r\nclass MessengerChat extends Component {\r\n  static propTypes = {\r\n    pageId: PropTypes.string.isRequired,\r\n    // appId:                    PropTypes.string.isRequired,\r\n    shouldShowDialog: PropTypes.bool,\r\n    htmlRef: PropTypes.string,\r\n    minimized: PropTypes.bool,\r\n    themeColor: PropTypes.string,\r\n    loggedInGreeting: PropTypes.string,\r\n    loggedOutGreeting: PropTypes.string,\r\n    greetingDialogDisplay: PropTypes.oneOf([\"show\", \"hide\", \"fade\"]),\r\n    greetingDialogDelay: PropTypes.number,\r\n    autoLogAppEvents: PropTypes.bool,\r\n    xfbml: PropTypes.bool,\r\n    version: PropTypes.string,\r\n    // language:                 PropTypes.string,\r\n    onCustomerChatDialogShow: PropTypes.func,\r\n    onCustomerChatDialogHide: PropTypes.func,\r\n  };\r\n\r\n  static defaultProps = {\r\n    shouldShowDialog: false,\r\n    htmlRef: undefined,\r\n    minimized: undefined,\r\n    themeColor: undefined,\r\n    loggedInGreeting: undefined,\r\n    loggedOutGreeting: undefined,\r\n    greetingDialogDisplay: undefined,\r\n    greetingDialogDelay: undefined,\r\n    autoLogAppEvents: true,\r\n    xfbml: true,\r\n    version: \"4.0\",\r\n    onCustomerChatDialogShow: undefined,\r\n    onCustomerChatDialogHide: undefined,\r\n  };\r\n\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.setFbAsyncInit = this.setFbAsyncInit.bind(this);\r\n    this.reloadSDKAsynchronously = this.reloadSDKAsynchronously.bind(this);\r\n    this.loadSDKAsynchronously = this.loadSDKAsynchronously.bind(this);\r\n    this.createMarkup = this.createMarkup.bind(this);\r\n    this.controlPlugin = this.controlPlugin.bind(this);\r\n    this.subscribeEvents = this.subscribeEvents.bind(this);\r\n    this.removeFacebookSDK = this.removeFacebookSDK.bind(this);\r\n\r\n    this.state = {\r\n      fbLoaded: false,\r\n      shouldShowDialog: undefined,\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.setFbAsyncInit();\r\n    this.reloadSDKAsynchronously();\r\n  }\r\n\r\n  componentDidUpdate(prevProps) {\r\n    if (\r\n      prevProps.pageId !== this.props.pageId ||\r\n      // prevProps.appId !== this.props.appId ||\r\n      prevProps.shouldShowDialog !== this.props.shouldShowDialog ||\r\n      prevProps.htmlRef !== this.props.htmlRef ||\r\n      prevProps.minimized !== this.props.minimized ||\r\n      prevProps.themeColor !== this.props.themeColor ||\r\n      prevProps.loggedInGreeting !== this.props.loggedInGreeting ||\r\n      prevProps.loggedOutGreeting !== this.props.loggedOutGreeting ||\r\n      prevProps.greetingDialogDisplay !== this.props.greetingDialogDisplay ||\r\n      prevProps.greetingDialogDelay !== this.props.greetingDialogDelay ||\r\n      prevProps.autoLogAppEvents !== this.props.autoLogAppEvents ||\r\n      prevProps.xfbml !== this.props.xfbml ||\r\n      prevProps.version !== this.props.version ||\r\n      prevProps.language !== this.props.language\r\n    ) {\r\n      this.setFbAsyncInit();\r\n      this.reloadSDKAsynchronously();\r\n    }\r\n  }\r\n\r\n  setFbAsyncInit() {\r\n    const { autoLogAppEvents, xfbml, version } = this.props;\r\n\r\n    window.fbAsyncInit = () => {\r\n      window.FB.init({\r\n        // appId,\r\n        autoLogAppEvents,\r\n        xfbml,\r\n        version: `v${version}`,\r\n      });\r\n\r\n      this.setState({ fbLoaded: true });\r\n    };\r\n  }\r\n\r\n  loadSDKAsynchronously() {\r\n    // const { language } = this.props\r\n    /* eslint-disable */\r\n    (function (d, s, id) {\r\n      var js,\r\n        fjs = d.getElementsByTagName(s)[0];\r\n      if (d.getElementById(id)) {\r\n        return;\r\n      }\r\n      js = d.createElement(s);\r\n      js.id = id;\r\n      js.src = `https://connect.facebook.net/en_GB/sdk/xfbml.customerchat.js`;\r\n      fjs.parentNode.insertBefore(js, fjs);\r\n    })(document, \"script\", \"facebook-jssdk\");\r\n    /* eslint-enable */\r\n  }\r\n\r\n  removeFacebookSDK() {\r\n    removeElementByIds([\"facebook-jssdk\", \"fb-root\"]);\r\n    delete window.FB;\r\n  }\r\n\r\n  reloadSDKAsynchronously() {\r\n    this.removeFacebookSDK();\r\n    this.loadSDKAsynchronously();\r\n  }\r\n\r\n  controlPlugin() {\r\n    const { shouldShowDialog } = this.props;\r\n\r\n    if (shouldShowDialog) {\r\n      window.FB.CustomerChat.showDialog();\r\n    } else {\r\n      window.FB.CustomerChat.hideDialog();\r\n    }\r\n  }\r\n\r\n  subscribeEvents() {\r\n    const { onCustomerChatDialogShow, onCustomerChatDialogHide } = this.props;\r\n\r\n    if (onCustomerChatDialogShow) {\r\n      window.FB.Event.subscribe(\r\n        \"customerchat.dialogShow\",\r\n        onCustomerChatDialogShow\r\n      );\r\n    }\r\n\r\n    if (onCustomerChatDialogHide) {\r\n      window.FB.Event.subscribe(\r\n        \"customerchat.dialogHide\",\r\n        onCustomerChatDialogHide\r\n      );\r\n    }\r\n  }\r\n\r\n  createMarkup() {\r\n    const {\r\n      pageId,\r\n      htmlRef,\r\n      minimized,\r\n      themeColor,\r\n      loggedInGreeting,\r\n      loggedOutGreeting,\r\n      greetingDialogDisplay,\r\n      greetingDialogDelay,\r\n    } = this.props;\r\n\r\n    const refAttribute = htmlRef !== undefined ? `ref=\"${htmlRef}\"` : \"\";\r\n\r\n    const minimizedAttribute =\r\n      minimized !== undefined ? `minimized=\"${minimized}\"` : \"\";\r\n\r\n    const themeColorAttribute =\r\n      themeColor !== undefined ? `theme_color=\"${themeColor}\"` : \"\";\r\n\r\n    const loggedInGreetingAttribute =\r\n      loggedInGreeting !== undefined\r\n        ? `logged_in_greeting=\"${loggedInGreeting}\"`\r\n        : \"\";\r\n\r\n    const loggedOutGreetingAttribute =\r\n      loggedOutGreeting !== undefined\r\n        ? `logged_out_greeting=\"${loggedOutGreeting}\"`\r\n        : \"\";\r\n\r\n    const greetingDialogDisplayAttribute =\r\n      greetingDialogDisplay !== undefined\r\n        ? `greeting_dialog_display=\"${greetingDialogDisplay}\"`\r\n        : \"\";\r\n\r\n    const greetingDialogDelayAttribute =\r\n      greetingDialogDelay !== undefined\r\n        ? `greeting_dialog_delay=\"${greetingDialogDelay}\"`\r\n        : \"\";\r\n\r\n    return {\r\n      __html: `<div\r\n             className=\"fb-customerchat\"\r\n             page_id=\"${pageId}\"\r\n             ${refAttribute}\r\n             ${minimizedAttribute}\r\n             ${themeColorAttribute}\r\n             ${loggedInGreetingAttribute}\r\n             ${loggedOutGreetingAttribute}\r\n             ${greetingDialogDisplayAttribute}\r\n             ${greetingDialogDelayAttribute}\r\n           ></div>`,\r\n    };\r\n  }\r\n\r\n  render() {\r\n    const { fbLoaded, shouldShowDialog } = this.state;\r\n\r\n    if (fbLoaded && shouldShowDialog !== this.props.shouldShowDialog) {\r\n      document.addEventListener(\r\n        \"DOMNodeInserted\",\r\n        (event) => {\r\n          const element = event.target;\r\n          if (\r\n            element.className &&\r\n            typeof element.className === \"string\" &&\r\n            element.className.includes(\"fb_dialog\")\r\n          ) {\r\n            this.controlPlugin();\r\n          }\r\n        },\r\n        false\r\n      );\r\n      this.subscribeEvents();\r\n    }\r\n    // Add a random key to rerender. Reference:\r\n    // https://stackoverflow.com/questions/30242530/dangerouslysetinnerhtml-doesnt-update-during-render\r\n    return <div key={Date()} dangerouslySetInnerHTML={this.createMarkup()} />;\r\n  }\r\n}\r\n\r\nexport default MessengerChat;\r\n"]},"metadata":{},"sourceType":"module"}